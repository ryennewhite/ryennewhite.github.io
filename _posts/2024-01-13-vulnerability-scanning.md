---
title: Vulnerability Scanning
date: 2024-01-13 10:53:00 -0600
categories: [OSCP]
tags: [oscp, pen200, offsec, certs]     # TAG names should always be lowercase
---
*The Vulnerability Scanning tools and tactics reviewed here are presented specifically in preparation for the OSCP exam per course suggestions and are by no means replacements for the OSCP training course, nor comprehensive guides for this step in the Kill Chain.*

# Vulnerability Scanning

Automated vulnerability scanners conduct Host Discovery, Port Scanning, OS, Service, and Version Detection, and compare results to vulnerability databases.

Scans can be internal or external, authenticated or unauthenticated.

## Scanning with Nessus

Start Nessus:
```console
$ sudo systemctl start nessusd.service
```

Go to https://kali:8834/ in your browser. When creating a Vulnerability Scan, consider the following:
- Should it be authenticated or unauthenticated?
- Do you need to scan UDP as well? This will take much longer.
- Do you need Host Discovery? Keeping this will ping each host. If you know your hosts are up, deselect this.
- Discovery > Identity provides an option to enumerate Active Directory users.

In the Vulnerabilities tab of the completed Report, sort by Vulnerability Priority Rating (VPR) to view prioritized results. 

To buid a Sitemap of a Webserver (scan web apps), conduct a Basic Network Scan on the web server(s) port(s). While creating the scan, under Assessment, select Custom > Web Applications > Scan web applications. In the completed Report, locate the finding titled "Web Application Sitemap".

To run an Authenticated Vulnerability Scan, choose Credentialed Patch Audit in the Scan Templates. After setting your target, view the Credentials tab. For Mac and Linux you can use SSH, and for Windows, you can use SMB or WMI. For SSH, choose the Authentication Method as password, input the Username, Password, select Elevate Privileges With sudo, input the Sudo User, and Sudo Password. *You may need to add exceptions in the antivirus, firewall, or Windows User Account Control (UAC) feature to allow Nessus to perform these authenticated scans.* In the Patch Report finding, you can see what patches are missing.

To run a scan with a specific plugin (to identify a specific CVE, for example) use the Advanced Dynamic Scan template. Set your target, submit your credentials, and view the Dynamic Plugins page. Configure your filter to find a plugin matching your criteria. Launch scan.

